apiVersion: v1
kind: ConfigMap
metadata:
  name: mip-config
  namespace: {{ .Values.namespace }}
data:
  INSTANCE_NAME: "{{ tpl .Values.mip.NAME . }}"
  INSTANCE_VERSION: "{{ tpl .Values.mip.VERSION_STRING . }}"

  EXAREME_IP: {{ .Values.engines.exareme.IP }}
  EXAREME_URL: {{ tpl .Values.engines.exareme.URL . }}
  EXAREME2_URL: {{ .Values.engines.exareme2.URL }}
  MIP_LINK: {{ .Values.mip.LINK }}
  EXTERNAL_MIP_PROTOCOL: {{ .Values.mip.EXTERNAL_PROTOCOL }}
  PUBLIC_MIP_PROTOCOL: {{ .Values.mip.PUBLIC_PROTOCOL }}
  PUBLIC_MIP_HOST: {{ .Values.mip.PUBLIC_HOST }}
  KEYCLOAK_AUTHENTICATION: "{{ .Values.keycloak.AUTHENTICATION }}"
  KEYCLOAK_HOSTNAME: {{ .Values.keycloak.URL }} # Only used with internal Keycloak auth
  KEYCLOAK_AUTH_URL: {{ .Values.keycloak.PROTOCOL }}://{{ .Values.keycloak.URL }}/auth/
  KEYCLOAK_REALM: {{ .Values.keycloak.REALM }}
  KEYCLOAK_CLIENT_ID: {{ .Values.keycloak.CLIENT_ID }}
  KEYCLOAK_CLIENT_SECRET: {{ .Values.keycloak.CLIENT_SECRET }}
  KEYCLOAK_SSL_REQUIRED: {{ .Values.keycloak.SSL_REQUIRED }}

  portalbackend.LOG_LEVEL: {{ .Values.portalbackend.LOG_LEVEL }}
  portalbackend.LOG_LEVEL_FRAMEWORK: {{ .Values.portalbackend.LOG_LEVEL_FRAMEWORK }}

  gateway.ENGINE_TYPE: {{ .Values.gateway.ENGINE_TYPE }}
  gateway.NODE_ENV: {{ .Values.gateway.NODE_ENV }}
  gateway.LOG_LEVEL: "{{ .Values.gateway.LOG_LEVEL }}"
  gateway.CACHE_ENABLED: "{{ .Values.gateway.CACHE_ENABLED }}"
  gateway.CACHE_TTL: "{{ .Values.gateway.CACHE_TTL }}"
  gateway.CACHE_MAX_ITEMS: "{{ .Values.gateway.CACHE_MAX_ITEMS }}"

  frontend.ERROR_LOG_LEVEL: {{ .Values.frontend.ERROR_LOG_LEVEL }}
  frontend.DATACATALOGUE_SERVER: {{ tpl .Values.frontend.DATACATALOGUE_PROTOCOL . }}://{{ tpl .Values.frontend.DATACATALOGUE_HOST . }}
  frontend.MATOMO_ENABLED: "{{ .Values.frontend.MATOMO_ENABLED }}"
  frontend.MATOMO_URL: {{ .Values.frontend.MATOMO_URL }}
  frontend.MATOMO_SITE_ID: "{{ .Values.frontend.MATOMO_SITE_ID }}"

  keycloak.PROXY_ADDRESS_FORWARDING: "{{ .Values.keycloak.PROXY_ADDRESS_FORWARDING }}"
